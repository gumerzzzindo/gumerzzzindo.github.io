# To-Do List: Análisis de Malware para Principiantes

Este documento describe una lista de tareas para practicar el análisis de malware en **Flare-VM**, enfocada en virus clásicos y muestras simples adecuadas para principiantes. Los objetivos son aprender técnicas de análisis estático y dinámico, identificar indicadores de compromiso (IOCs), y documentar hallazgos para mejorar tus habilidades en ciberseguridad.

## Tareas Generales

- [ ] **Configurar el entorno de análisis:**
  - Asegúrate de que Flare-VM esté completamente aislada (sin conexión a la red de producción, snapshots habilitados).
  - Crea una VM secundaria con Windows XP o 7 para malware antiguo (Jerusalem, Christmas Tree, HI.COM, Wank Worm).
  - Instala **REMnux** en una VM separada para análisis complementario en Linux (opcional).
- [ ] **Descargar muestras seguras:**
  - Usa repositorios como **theZoo** (http://thezoo.morirt.com/), **VX-Underground** (https://www.vx-underground.org/), o **Malware-Traffic-Analysis.net** (https://www.malware-traffic-analysis.net/) con la contraseña "infected".
  - Verifica los hashes de las muestras en **VirusTotal** (https://www.virustotal.com/) antes de analizarlas.
- [ ] **Familiarizarte con herramientas de Flare-VM:**
  - Practica con **PE Studio**, **ProcMon**, **Wireshark**, **oletools**, **IDA Free**, y **x64dbg**.
  - Revisa tutoriales de **SANS** (https://www.sans.org/) o **Hack The Box Academy** (https://academy.hackthebox.com/) para aprender su uso.
- [ ] **Documentar hallazgos:**
  - Crea un informe por cada virus, incluyendo IOCs (IPs, dominios, cambios en el registro) y capturas de pantalla.
  - Compara resultados con write-ups en **Malware-Traffic-Analysis.net** (https://www.malware-traffic-analysis.net/) o foros como Reddit (https://www.reddit.com/r/Malware/, https://www.reddit.com/r/MalwareAnalysis/).

## Virus a Analizar

1. **Jerusalem Virus**
   - [ ] Descargar muestra desde theZoo o VX-Underground.
   - [ ] Realizar análisis estático.
   - [ ] Realizar análisis dinámico.
   - [ ] Documentar IOCs.

2. **Zeus Trojan**
   - [ ] Descargar muestra desde Malware-Traffic-Analysis.net o theZoo.
   - [ ] Realizar análisis estático.
   - [ ] Realizar análisis dinámico.
   - [ ] Documentar IOCs.

3. **Documentos con Macros VBA**
   - [ ] Descargar muestra desde Malware-Traffic-Analysis.net o VX-Underground.
   - [ ] Realizar análisis estático.
   - [ ] Realizar análisis dinámico.
   - [ ] Documentar IOCs.

4. **Flare-On Challenges**
   - [ ] Descargar un desafío de Flare-On (https://www.flare-on.com/) o Crackmes.de (https://crackmes.de/).
   - [ ] Realizar análisis estático.
   - [ ] Realizar análisis dinámico.
   - [ ] Documentar IOCs.

5. **Christmas Tree (CHRISTMA EXEC)**
   - [ ] Descargar muestra desde VX-Underground o theZoo.
   - [ ] Realizar análisis estático.
   - [ ] Realizar análisis dinámico.
   - [ ] Documentar IOCs.

6. **HI.COM**
   - [ ] Descargar muestra desde VX-Underground o theZoo.
   - [ ] Realizar análisis estático.
   - [ ] Realizar análisis dinámico.
   - [ ] Documentar IOCs.

7. **Wank Worm**
   - [ ] Descargar muestra desde VX-Underground or theZoo.
   - [ ] Realizar análisis estático.
   - [ ] Realizar análisis dinámico.
   - [ ] Documentar IOCs.

8. **Win Script Rabbit**
   - [ ] Descargar muestra desde VX-Underground o Malware-Traffic-Analysis.net.
   - [ ] Realizar análisis estático.
   - [ ] Realizar análisis dinámico.
   - [ ] Documentar IOCs.

## Tareas Específicas por Virus

### 1. Jerusalem Virus
- **Descripción**: Virus de DOS de 1987 que infecta archivos `.COM` y `.EXE`, aumentando su tamaño y mostrando mensajes ocasionales. Simple, sin ofuscación.
- **Tareas**:
  - **Análisis estático**:
    - [ ] Calcula el hash MD5/SHA256 con:
      ```bash
      md5sum jerusalem.exe
      ```
      Verifica en **VirusTotal** para confirmar la muestra.
    - [ ] Extrae strings con **BinText** o:
      ```bash
      strings jerusalem.exe > strings.txt
      ```
      Busca mensajes como "sUMsDos" o nombres de archivos infectados.
    - [ ] Usa **PEview** o **PE Studio** para inspeccionar el encabezado PE y confirmar que no está empaquetado.
  - **Análisis dinámico**:
    - [ ] Configura una VM con Windows XP o DOSBox (en Flare-VM) para ejecutar el virus.
    - [ ] Usa **Process Monitor** (ProcMon) para monitorear cambios en el sistema de archivos (e.g., archivos `.EXE` modificados).
    - [ ] Observa el comportamiento con **Process Explorer** para detectar procesos sospechosos.
  - **Documentación**:
    - [ ] Registra IOCs (e.g., nombres de archivos infectados, mensajes mostrados).
    - [ ] Toma capturas de pantalla de ProcMon mostrando cambios en el sistema.
  - **Conexión con el informe**: Practicar con Jerusalem te ayudará a entender cómo un atacante podría propagar malware en la red de EAGI si explota contraseñas débiles (como `icalvo:12345678`) para distribuir archivos infectados.

### 2. Zeus Trojan
- **Descripción**: Troyano bancario (2007-2010) que roba credenciales y realiza inyecciones web. Sus primeras versiones tienen ofuscación mínima, ideal para principiantes.
- **Tareas**:
  - **Análisis estático**:
    - [ ] Calcula el hash y compáralo en VirusTotal.
    - [ ] Usa **PE Studio** para revisar DLLs importadas (e.g., `Ws2_32.dll` para conexiones de red).
    - [ ] Extrae strings para identificar URLs de servidores C2 o claves de registro (e.g., `HKLM\Software\Microsoft\Windows\CurrentVersion\Run`).
  - **Análisis dinámico**:
    - [ ] Ejecuta el troyano en Flare-VM (Windows 7 recomendado).
    - [ ] Usa **Wireshark** para capturar tráfico de red y detectar conexiones C2.
    - [ ] Monitorea con **ProcMon** cambios en el registro o archivos creados (e.g., `zeus.bin`).
    - [ ] Configura **ApateDNS** para redirigir tráfico a una IP falsa y evitar conexiones reales.
  - **Documentación**:
    - [ ] Registra IOCs (IPs, dominios, claves de registro).
    - [ ] Compara con write-ups en **Malware-Traffic-Analysis.net**.
  - **Conexión con el informe**: Zeus podría aprovechar vulnerabilidades como SMB sin firmar (como en tu ataque SMB Relay) para propagarse en la red de EAGI, robando credenciales como `bizitaria:bizitaria`.

### 3. Documentos con Macros VBA
- **Descripción**: Documentos Word/Excel con macros VBA que descargan payloads o ejecutan comandos maliciosos. Simples y comunes en ataques de phishing.
- **Tareas**:
  - **Análisis estático**:
    - [ ] Usa **oletools** para extraer macros:
      ```bash
      olevba malicious.doc
      ```
      Busca funciones como `Shell`, `CreateObject`, o URLs de descarga.
    - [ ] Analiza el código VBA en busca de ofuscación simple (e.g., cadenas codificadas en Base64).
  - **Análisis dinámico**:
    - [ ] Abre el documento en una VM con Office (Windows 7 o 10).
    - [ ] Habilita macros y monitorea con **ProcMon** para detectar procesos creados (e.g., `powershell.exe`).
    - [ ] Usa **Wireshark** para capturar tráfico de red (e.g., descargas de payloads).
  - **Documentación**:
    - [ ] Registra IOCs (URLs, comandos ejecutados, archivos descargados).
    - [ ] Incluye capturas de pantalla de la macro VBA y ProcMon.
  - **Conexión con el informe**: Un documento malicioso podría explotar la falta de concienciación de usuarios en EAGI (e.g., abriendo archivos en la carpeta de escaneos accesible por `bizitaria`), propagando malware en la red.

### 4. Flare-On Challenges
- **Descripción**: Binarios educativos diseñados por FireEye para aprender análisis de malware. Simples, sin ofuscación extrema, con write-ups disponibles.
- **Tareas**:
  - **Análisis estático**:
    - [ ] Carga el binario en **IDA Free** para analizar el código ensamblador.
    - [ ] Busca funciones sospechosas (e.g., `CreateProcess`, `WriteFile`).
    - [ ] Extrae strings con **BinText** para identificar mensajes o claves.
  - **Análisis dinámico**:
    - [ ] Depura el binario con **x64dbg** para seguir su ejecución paso a paso.
    - [ ] Usa **ProcMon** para detectar cambios en el sistema (e.g., archivos creados).
  - **Documentación**:
    - [ ] Registra IOCs y compara con write-ups de Flare-On (https://www.flare-on.com/).
    - [ ] Documenta el flujo de ejecución del binario (e.g., funciones clave).
  - **Conexión con el informe**: Los desafíos Flare-On te ayudarán a practicar técnicas de ingeniería inversa, útiles para analizar payloads descargados en la red de EAGI si un atacante explota vulnerabilidades como XML-RPC.

### 5. Christmas Tree (CHRISTMA EXEC)
- **Descripción**: Gusano de 1987 para sistemas IBM, distribuido por correo electrónico. Muestra un árbol de Navidad en pantalla y se propaga reenviándose. Muy simple, sin ofuscación.
- **Tareas**:
  - **Análisis estático**:
    - [ ] Descarga la muestra (formato REXX) desde VX-Underground.
    - [ ] Usa **strings** para extraer el código fuente REXX y buscar comandos de correo o mensajes gráficos.
    - [ ] Analiza el script con un editor de texto para entender su lógica de propagación.
  - **Análisis dinámico**:
    - [ ] Configura una VM con IBM PC DOS o emulador (e.g., PCem) para ejecutar el gusano.
    - [ ] Monitorea con **ProcMon** (si usas Windows) o un emulador para observar la creación del árbol y envíos de correo simulados.
  - **Documentación**:
    - [ ] Registra IOCs (e.g., direcciones de correo simuladas, archivos creados).
    - [ ] Captura la pantalla del árbol de Navidad como evidencia.
  - **Conexión con el informe**: Este gusano te ayudará a entender ataques basados en ingeniería social, que podrían explotar la falta de concienciación en EAGI para propagar malware.

### 6. HI.COM
- **Descripción**: Virus de DOS de los años 80 que infecta archivos `.COM`. Simple, con comportamiento visible (e.g., mensajes en pantalla).
- **Tareas**:
  - **Análisis estático**:
    - [ ] Calcula el hash y verifica en VirusTotal.
    - [ ] Usa **PEview** para inspeccionar el encabezado del archivo `.COM`.
    - [ ] Extrae strings con:
      ```bash
      strings hi.com > strings.txt
      ```
      Busca mensajes o nombres de archivos infectados.
  - **Análisis dinámico**:
    - [ ] Ejecuta en DOSBox o Windows XP en Flare-VM.
    - [ ] Usa **Process Explorer** para detectar procesos creados.
    - [ ] Monitorea cambios en el sistema de archivos con **ProcMon**.
  - **Documentación**:
    - [ ] Registra IOCs (e.g., archivos infectados, mensajes mostrados).
    - [ ] Captura pantallas de ProcMon o del mensaje del virus.
  - **Conexión con el informe**: Similar a Jerusalem, HI.COM te ayudará a practicar análisis de infecciones de archivos, relevante para entender cómo malware podría propagarse en la red de EAGI.

### 7. Wank Worm
- **Descripción**: Gusano de 1989 que atacó sistemas VMS, mostrando mensajes políticos y propagándose por redes DECnet. Simple y no ofuscado.
- **Tareas**:
  - **Análisis estático**:
    - [ ] Descarga la muestra desde VX-Underground.
    - [ ] Usa **strings** para extraer mensajes políticos o comandos de propagación.
    - [ ] Analiza el código fuente (si está disponible en DCL) con un editor de texto.
  - **Análisis dinámico**:
    - [ ] Configura un emulador VMS (e.g., SIMH) para ejecutar el gusano.
    - [ ] Monitorea con herramientas de red (si es posible) para simular propagación DECnet.
  - **Documentación**:
    - [ ] Registra IOCs (e.g., mensajes mostrados, archivos modificados).
    - [ ] Captura pantallas del comportamiento del gusano.
  - **Conexión con el informe**: Wank Worm te ayudará a entender la propagación en red, relevante para vulnerabilidades como la segmentación insuficiente en EAGI.

### 8. Win Script Rabbit
- **Descripción**: Gusano de Windows basado en scripts (posiblemente VBS o JS) que se propaga creando copias de sí mismo. Simple, ideal para análisis de scripts.
- **Tareas**:
  - **Análisis estático**:
    - [ ] Usa **oletools** o un editor de texto para analizar el script VBS/JS.
    - [ ] Busca funciones de copia (e.g., `FileSystemObject.CopyFile`) o conexiones de red.
  - **Análisis dinámico**:
    - [ ] Ejecuta el script en una VM Windows 7 o 10.
    - [ ] Usa **ProcMon** para detectar archivos creados o procesos iniciados.
    - [ ] Monitorea tráfico de red con **Wireshark** si el script intenta conectarse.
  - **Documentación**:
    - [ ] Registra IOCs (e.g., nombres de archivos creados, URLs contactadas).
    - [ ] Captura pantallas del código y ProcMon.
  - **Conexión con el informe**: Este gusano es relevante para practicar análisis de scripts, que podrían explotar vulnerabilidades en EAGI (e.g., usuarios abriendo scripts maliciosos en la carpeta de escaneos).

## Notas Adicionales

- **Seguridad**: Siempre analiza malware en un entorno aislado (Flare-VM con snapshots). Nunca ejecutes muestras en tu máquina host.
- **Prioridad**: Comienza con **Jerusalem Virus** y **Documentos con Macros VBA**, ya que son los más simples y usan herramientas estándar de Flare-VM.
- **Recursos**:
  - **SANS**: Blog de Lenny Zeltser para técnicas básicas (https://www.sans.org/).
  - **Malware-Traffic-Analysis.net**: Muestras y PCAPs con write-ups (https://www.malware-traffic-analysis.net/).
  - **Practical Malware Analysis**: Libro con laboratorios prácticos (https://www.amazon.com/Practical-Malware-Analysis-Hands-Dissecting/dp/1593272901).
  - **Flare-On Challenges**: Desafíos educativos (https://www.flare-on.com/).
- **Conexión con el informe**: Estos virus te ayudarán a entender cómo un atacante podría explotar vulnerabilidades como contraseñas débiles, SMB sin firmar, o carpetas compartidas accesibles por `bizitaria` para propagar malware en la red de EAGI.